<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width" />
<title>fom</title>
<script src="js/jquery-3.3.1.js"></script> 
<script src="js/dataTables.js"></script>
<link href="js/dataTables.css" rel="stylesheet" />
<style type="text/css">
td.details-control {
    background: url('images/details_open.png') no-repeat center center;
    cursor: pointer;
}
img{
   background: no-repeat center center;
    cursor: pointer;
}
</style>
</head>
<body>
    <table id="fom" class="display nowrap" style="width:100%">
        <thead>
            <tr>
			    <th></th>
                <th>name</th>
                <th>cron expression</th>
                <th>state</th>
				<th>create time</th>
				<th>last start time</th>
                <th>option</th>
            </tr>
        </thead>
    </table>
</body>
<script type="text/javascript">
$(document).ready(function() {
    var table = $('#fom').DataTable( {
    	"ajax": "/fom/list",
        "columns": [
            {
                "class":          "details-control",
                "data":           null,
                "orderable":      false,
                "defaultContent": ""
            },
            { "data": "name" },
            { "data": "cron", "orderable": false},
            { "data": "state"},
            { "data": "creatTime"},
            { "data": "startTime"},
            { "defaultContent": "<img title='start' src='images/start.png' onclick='start(this)'/>" 
            	 + "<img title='stop' src='images/stop.png' onclick='stop(this)'/>"
            	 + "<img title='execute immediately' src='images/exec.png' onclick='exec(this)'/>"
            	 , "orderable": false},
        ],
        "createdRow": function ( row, data, index ) {
        	
        },
        "order": [[1, 'asc']]
    } );
     
    $('#fom tbody').on('click', 'td.details-control', function () {
        var tr = $(this).closest('tr');
        var row = table.row( tr );
        if ( row.child.isShown() ) {
        	$(this).css("background","url('images/details_open.png') no-repeat center center");
            row.child.hide();
            tr.removeClass('shown');
        }
        else {
        	$(this).css("background","url('images/details_close.png') no-repeat center center");
            row.child( format(row.data()) ).show();
            tr.addClass('shown');
        }
    } );
} );

function format ( data ) {
	var html = '<table cellpadding="5" cellspacing="0" border="0" style="padding-left:50px;">';
	for(var key in data){
		if(key == "name" || key == "startTime"
				|| key == "creatTime" || key == "state"){
			continue;
		}
		html =  html + '<tr><td>' + key + ':</td><td>' + data[key] + '</td></tr>';
	}
    return html + '</table>';
}

function start(e){
	var v = $(e).parent().parent().find('td').eq(1).html();
	alert(v);
}

function stop(e){
	var v = $(e).parent().parent().find('td').eq(1).html();
	alert(v);
}

function exec(e){
	var v = $(e).parent().parent().find('td').eq(1).html();
	alert(v);
}
</script>
</html>